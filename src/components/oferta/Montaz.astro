---
// src/components/oferta/Montaz.astro
import { companyConfig } from '../../data/companyConfig';
---

<section id="montaz" class="py-12 md:py-20 bg-white scroll-mt-24">
  
  <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
    
    <!-- 1. NAGŁÓWEK NA CAŁĄ SZEROKOŚĆ -->
    <div class="text-center mb-10">
      <h2 class="text-3xl md:text-4xl font-bold text-airtur-dark">
        Precyzyjny Montaż i Zasada Idealnego Porządku
      </h2>
    </div>

    <!-- 2. ZDJĘCIE I OPIS -->
    <div class="flex flex-col lg:flex-row gap-8 lg:gap-12 mb-16 items-stretch">
      
      <!-- Lewa: Zdjęcie -->
      <div class="w-full lg:w-1/2 min-h-[300px]">
        <img 
          src="/montaz.jpg" 
          alt="Instalator AirTUR podczas pracy" 
          class="w-full h-full object-cover rounded-xl shadow-lg"
        />
      </div>

      <!-- Prawa: Tekst -->
      <div class="w-full lg:w-1/2 flex flex-col justify-center">
        <p class="text-lg text-gray-600 leading-relaxed">
          Nasza filozofia montażu opiera się na trzech filarach: precyzji, porządku i terminowości. Doświadczenie zdobyte na najbardziej wymagających rynkach europejskich nauczyło nas, że jakość tkwi w detalach. <br><br>
          Każdy montaż traktujemy z najwyższym szacunkiem dla Twojego domu – naszym celem jest, aby cały proces przebiegł sprawnie, bez bałaganu i niepotrzebnego stresu.
        </p>
      </div>

    </div>

  </div>

  <!-- 3. PROCES W 5 KROKACH -->
  <div class="bg-gray-50 py-12 border-y border-gray-200">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 text-center">
      
      <h3 class="text-2xl font-bold text-airtur-dark mb-10">
        Nasz Proces – Twój Spokój w 5 Krokach
      </h3>

      <div class="grid grid-cols-1 md:grid-cols-3 lg:grid-cols-5 gap-8">
        
        <div class="flex flex-col items-center">
          <div class="w-12 h-12 rounded-full bg-airtur-blue text-white flex items-center justify-center text-xl font-bold mb-3 shadow-md">1</div>
          <h4 class="font-bold text-lg text-airtur-dark mb-1">Analiza i audyt</h4>
          <p class="text-sm text-gray-600 leading-relaxed">Zaczynamy od zrozumienia Twoich celów i warunków technicznych, a nie od wyboru urządzenia.</p>
        </div>

        <div class="flex flex-col items-center">
          <div class="w-12 h-12 rounded-full bg-airtur-blue text-white flex items-center justify-center text-xl font-bold mb-3 shadow-md">2</div>
          <h4 class="font-bold text-lg text-airtur-dark mb-1">Kalkulacja ROI</h4>
          <p class="text-sm text-gray-600 leading-relaxed">Otrzymujesz od nas oparte na danych szacunki zwrotu z inwestycji (ROI) oraz finalną, szczegółową wycenę.</p>
        </div>

        <div class="flex flex-col items-center">
          <div class="w-12 h-12 rounded-full bg-airtur-blue text-white flex items-center justify-center text-xl font-bold mb-3 shadow-md">3</div>
          <h4 class="font-bold text-lg text-airtur-dark mb-1">Dobór systemu</h4>
          <p class="text-sm text-gray-600 leading-relaxed">Rekomendujemy wyłącznie sprawdzone urządzenia, które zapewniają najlepszy zwrot z inwestycji.</p>
        </div>

        <div class="flex flex-col items-center">
          <div class="w-12 h-12 rounded-full bg-airtur-blue text-white flex items-center justify-center text-xl font-bold mb-3 shadow-md">4</div>
          <h4 class="font-bold text-lg text-airtur-dark mb-1">Czysty montaż</h4>
          <p class="text-sm text-gray-600 leading-relaxed">Jesteśmy w umówionym dniu i rygorystycznie przestrzegamy naszej Zasady Idealnego Porządku.</p>
        </div>

        <div class="flex flex-col items-center">
          <div class="w-12 h-12 rounded-full bg-airtur-blue text-white flex items-center justify-center text-xl font-bold mb-3 shadow-md">5</div>
          <h4 class="font-bold text-lg text-airtur-dark mb-1">Instruktaż</h4>
          <p class="text-sm text-gray-600 leading-relaxed">Nie zostawiamy Cię z samym pilotem. Uczymy pełnej kontroli nad systemem i dbaniem o filtry.</p>
        </div>

      </div>

    </div>
  </div>

  <!-- 4. FORMULARZE Z WYRAŹNYM PRZEŁĄCZNIKIEM -->
  <div class="max-w-3xl mx-auto px-4 sm:px-6 lg:px-8 mt-16">
    
    <div class="text-center mb-8">
      <h3 class="text-2xl font-bold text-airtur-dark">
        Masz pytania dotyczące montażu? Wybierz formę kontaktu:
      </h3>
    </div>

    <!-- TABY -->
    <div class="flex flex-col sm:flex-row justify-center gap-4 mb-8">
      
      <button id="tab-email" class="w-full sm:w-auto px-6 py-3 rounded-lg border-2 border-airtur-dark text-sm font-bold uppercase tracking-wide transition-all bg-airtur-dark text-white shadow-lg cursor-pointer">
        Chcę napisać e-mail
      </button>
      
      <button id="tab-phone" class="w-full sm:w-auto px-6 py-3 rounded-lg border-2 border-airtur-dark text-sm font-bold uppercase tracking-wide transition-all bg-white text-airtur-dark hover:bg-gray-100 cursor-pointer">
        Preferuję kontakt telefoniczny
      </button>

    </div>

    <!-- FORMULARZ 1: E-MAIL (Domyślny) -->
    <div id="form-email" class="bg-white p-6 md:p-8 rounded-2xl shadow-xl border border-gray-200">
      <form 
        id="montaz-form-mail"
        name="zapytanie-montaz-mail" 
        method="POST" 
        data-netlify="true" 
        action="/podziekowanie?cel=montaz"
        class="space-y-4"
        novalidate
      >
        <input type="hidden" name="form-name" value="zapytanie-montaz-mail" />
        <input type="hidden" name="source" value="podstrona_oferta_sekcja_montaz_email" />

        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
          <div>
            <label for="name-mail" class="block text-sm font-bold text-airtur-dark mb-1">Imię</label>
            <input type="text" id="name-mail" name="name" required class="w-full px-4 py-2 rounded-lg border border-gray-300 focus:border-airtur-blue focus:ring-2 focus:ring-airtur-blue/20 outline-none transition bg-gray-50" placeholder="Wpisz swoje imię">
          </div>
          <div>
            <label for="email-field" class="block text-sm font-bold text-airtur-dark mb-1">E-mail</label>
            <input type="email" id="email-field" name="email" required class="w-full px-4 py-2 rounded-lg border border-gray-300 focus:border-airtur-blue focus:ring-2 focus:ring-airtur-blue/20 outline-none transition bg-gray-50" placeholder="twoj@email.pl">
          </div>
        </div>
        
        <div>
          <label for="message-mail" class="block text-sm font-bold text-airtur-dark mb-1">Treść wiadomości</label>
          <textarea 
            id="message-mail" 
            name="message"
            rows="5" 
            class="w-full px-4 py-2 rounded-lg border border-gray-300 focus:border-airtur-blue focus:ring-2 focus:ring-airtur-blue/20 outline-none transition bg-gray-50 text-gray-700 placeholder-gray-400"
            placeholder="Dzień dobry,&#10;Proszę o przygotowanie analizy i oferty na montaż.&#10;Moja lokalizacja: [np. Dom w okolicy Nowego Sącza]&#10;Powierzchnia pomieszczenia: [np. ok. 30 m²]&#10;Mój główny cel to: [np. Oszczędność na ogrzewaniu / Chłodzenie latem]"
          ></textarea>
        </div>

        <!-- BŁĄD WALIDACJI MAIL -->
        <div id="error-mail" class="hidden text-red-500 text-xs font-bold italic py-1">Proszę podać poprawny adres e-mail.</div>

        <!-- ZGODA RODO + REGULAMIN (Montaż) -->
<div class="flex items-start pt-2">
    <div class="flex items-center h-5">
      <input 
        id="consent-montaz-mail" 
        name="consent-montaz-mail" 
        type="checkbox" 
        required 
        class="w-5 h-5 text-airtur-blue border-gray-300 rounded focus:ring-airtur-blue cursor-pointer"
      >
    </div>
    <div class="ml-3 text-sm leading-snug">
      <label for="consent-montaz-mail" class="text-gray-600 cursor-pointer">
        Akceptuję <a href="/regulamin" class="text-airtur-blue hover:underline font-semibold">Regulamin</a> oraz wyrażam zgodę na przetwarzanie danych osobowych zgodnie z <a href="/polityka-prywatnosci" class="text-airtur-blue hover:underline font-semibold">Polityką Prywatności</a> w celu obsługi zapytania ofertowego.
      </label>
    </div>
</div>

        <button type="submit" class="w-full bg-airtur-blue text-white font-bold py-3 rounded-lg hover:bg-opacity-90 transition shadow-md uppercase tracking-wide cursor-pointer">
          WYŚLIJ WIADOMOŚĆ
        </button>
      </form>
    </div>

    <!-- FORMULARZ 2: TELEFON (Ukryty) -->
    <div id="form-phone" class="hidden bg-white p-6 md:p-8 rounded-2xl shadow-xl border border-gray-200">
      <form 
        id="montaz-form-phone"
        name="zapytanie-montaz-phone" 
        method="POST" 
        data-netlify="true" 
        action="/podziekowanie?cel=montaz"
        class="space-y-4"
        novalidate
      >
        <input type="hidden" name="form-name" value="zapytanie-montaz-phone" />
        <input type="hidden" name="source" value="podstrona_oferta_sekcja_montaz_telefon" />

        <div class="text-center mb-6 bg-blue-50 p-3 rounded-lg border border-blue-100">
            <p class="text-airtur-dark font-medium text-sm">Zostaw swój numer. Oddzwonimy, by omówić szczegóły montażu.</p>
        </div>
        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
            <div>
            <label for="name-phone" class="block text-sm font-bold text-airtur-dark mb-1">Imię</label>
            <input type="text" id="name-phone" name="name" required class="w-full px-4 py-2 rounded-lg border border-gray-300 focus:border-airtur-blue focus:ring-2 focus:ring-airtur-blue/20 outline-none transition bg-gray-50" placeholder="Wpisz swoje imię">
            </div>
            <div>
            <label for="phone-field" class="block text-sm font-bold text-airtur-dark mb-1">Numer telefonu</label>
            <input type="tel" id="phone-field" name="phone" required class="w-full px-4 py-2 rounded-lg border border-gray-300 focus:border-airtur-blue focus:ring-2 focus:ring-airtur-blue/20 outline-none transition bg-gray-50" placeholder="+48 ...">
            </div>
        </div>

        <!-- BŁĄD WALIDACJI TELEFON -->
        <div id="error-phone" class="hidden text-red-500 text-xs font-bold italic py-1">Numer telefonu powinien zawierać minimum 9 cyfr.</div>

        <!-- ZGODA RODO (Telefon) -->
        <div class="flex items-start pt-2">
            <div class="flex items-center h-5">
              <input id="consent-montaz-phone" type="checkbox" required class="w-5 h-5 text-airtur-blue border-gray-300 rounded focus:ring-airtur-blue cursor-pointer">
            </div>
            <div class="ml-3 text-sm leading-snug">
              <label for="consent-montaz-phone" class="text-gray-600 cursor-pointer">
                Akceptuję <a href="/regulamin" class="text-airtur-blue hover:underline font-semibold">Regulamin</a> oraz wyrażam zgodę na przetwarzanie danych osobowych zgodnie z <a href="/polityka-prywatnosci" class="text-airtur-blue hover:underline font-semibold">Polityką Prywatności</a> w celu kontaktu telefonicznego.
              </label>
            </div>
        </div>

        <button type="submit" class="w-full bg-airtur-dark text-white font-bold py-3 rounded-lg hover:bg-opacity-90 transition shadow-md uppercase tracking-wide cursor-pointer">
          PROSZĘ O TELEFON
        </button>
      </form>
    </div>

  </div>
</section>

<script>
  // 1. LOGIKA TABÓW (TWOJA ORYGINALNA)
  const tabEmail = document.getElementById('tab-email');
  const tabPhone = document.getElementById('tab-phone');
  const formEmailContainer = document.getElementById('form-email');
  const formPhoneContainer = document.getElementById('form-phone');

  const activeClassAdd = ['bg-airtur-dark', 'text-white'];
  const activeClassRemove = ['bg-white', 'text-airtur-dark', 'hover:bg-gray-100'];
  const inactiveClassAdd = ['bg-white', 'text-airtur-dark', 'hover:bg-gray-100'];
  const inactiveClassRemove = ['bg-airtur-dark', 'text-white'];

  tabEmail?.addEventListener('click', () => {
    formEmailContainer?.classList.remove('hidden');
    formPhoneContainer?.classList.add('hidden');
    tabEmail.classList.add(...activeClassAdd);
    tabEmail.classList.remove(...activeClassRemove);
    tabPhone?.classList.add(...inactiveClassAdd);
    tabPhone?.classList.remove(...inactiveClassRemove);
  });

  tabPhone?.addEventListener('click', () => {
    formPhoneContainer?.classList.remove('hidden');
    formEmailContainer?.classList.add('hidden');
    tabPhone.classList.add(...activeClassAdd);
    tabPhone.classList.remove(...activeClassRemove);
    tabEmail?.classList.add(...inactiveClassAdd);
    tabEmail?.classList.remove(...inactiveClassRemove);
  });

  // 2. LOGIKA WALIDACJI (NOWA)
  document.addEventListener('DOMContentLoaded', () => {
    const emailForm = document.getElementById('montaz-form-mail');
    const phoneForm = document.getElementById('montaz-form-phone');

    const isValidEmail = (email) => {
        return /^(([^<>()[\]\\.,;:\s@"]+(\.[^<>()[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/.test(String(email).toLowerCase());
    };

    const isValidPhone = (phone) => {
        const digits = phone.replace(/\D/g, "");
        return digits.length >= 9;
    };

    // Obsługa Formularza E-mail
    emailForm?.addEventListener('submit', (e) => {
        const emailInput = document.getElementById('email-field');
        const errorMsg = document.getElementById('error-mail');
        if (!isValidEmail(emailInput.value)) {
            e.preventDefault();
            errorMsg?.classList.remove('hidden');
            emailInput.classList.add('border-red-400');
            emailInput.focus();
        }
    });

    // Obsługa Formularza Telefon
    phoneForm?.addEventListener('submit', (e) => {
        const phoneInput = document.getElementById('phone-field');
        const errorMsg = document.getElementById('error-phone');
        if (!isValidPhone(phoneInput.value)) {
            e.preventDefault();
            errorMsg?.classList.remove('hidden');
            phoneInput.classList.add('border-red-400');
            phoneInput.focus();
        }
    });

    // Usuwanie błędów przy wpisywaniu
    document.querySelectorAll('input').forEach(input => {
        input.addEventListener('input', () => {
            input.classList.remove('border-red-400');
            document.getElementById('error-mail')?.classList.add('hidden');
            document.getElementById('error-phone')?.classList.add('hidden');
        });
    });
  });
</script>